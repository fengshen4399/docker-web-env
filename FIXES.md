# é—®é¢˜ä¿®å¤æ€»ç»“

## ğŸ”§ å·²ä¿®å¤çš„é—®é¢˜

### 1. web.sh è„šæœ¬è·¯å¾„é—®é¢˜
**é—®é¢˜**: `./scripts/web.sh: line 126: ./manage.sh: No such file or directory`

**åŸå› **: `web.sh` è„šæœ¬ä¸­éƒ¨åˆ†å‡½æ•°ä½¿ç”¨äº†é”™è¯¯çš„è·¯å¾„ `./manage.sh` è€Œä¸æ˜¯ `./scripts/manage.sh`

**ä¿®å¤**: ç»Ÿä¸€æ‰€æœ‰è·¯å¾„å¼•ç”¨ä¸º `./scripts/manage.sh`

**å½±å“æ–‡ä»¶**:
- `scripts/web.sh` - ä¿®å¤äº† `restart_nginx()`, `restart_php()`, `reload_config()`, `rebuild_service()` å‡½æ•°

### 2. åº”ç”¨æ—¥å¿—ç›®å½•æƒé™é—®é¢˜
**é—®é¢˜**: åº”ç”¨æ— æ³•å†™å…¥ `/home/app/default/runtime` ç›®å½•

**åŸå› **: 
- ç›®å½•æƒé™è®¾ç½®ä¸æ­£ç¡®
- å®¹å™¨å†…ç”¨æˆ·æ— æ³•å†™å…¥åº”ç”¨è¿è¡Œæ—¶ç›®å½•

**ä¿®å¤**: 
- ç§»é™¤äº†å¤šä½™çš„å•ç‹¬æŒ‚è½½ `- /home/app/default/runtime:/www/runtime`
- æ·»åŠ äº†æƒé™ä¿®å¤åŠŸèƒ½
- ç¡®ä¿ `runtime` ç›®å½•åŠå…¶å­ç›®å½•æœ‰æ­£ç¡®çš„å†™æƒé™

**å½±å“æ–‡ä»¶**:
- `docker-compose.yml` - ç§»é™¤å¤šä½™æŒ‚è½½
- `scripts/manage.sh` - æ·»åŠ  `fix-perms` å‘½ä»¤
- `install.sh` - æ·»åŠ æƒé™è®¾ç½®
- `deploy.sh` - æ·»åŠ æƒé™è®¾ç½®

## ğŸš€ æ–°å¢åŠŸèƒ½

### 1. æƒé™ä¿®å¤å‘½ä»¤
```bash
# ä½¿ç”¨ web å‘½ä»¤
sudo web fix-perms

# æˆ–ç›´æ¥ä½¿ç”¨ manage.sh
./scripts/manage.sh fix-perms
```

### 2. å¿«é€Ÿä¿®å¤è„šæœ¬
```bash
./quick-fix.sh
```

## ğŸ“ ç›®å½•ç»“æ„è¯´æ˜

```
/home/app/default/              # åº”ç”¨æ ¹ç›®å½•ï¼ˆæŒ‚è½½åˆ°å®¹å™¨ /www/ï¼‰
â”œâ”€â”€ index.php                   # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ health.php                  # å¥åº·æ£€æŸ¥æ–‡ä»¶
â””â”€â”€ runtime/                    # è¿è¡Œæ—¶ç›®å½•ï¼ˆåº”ç”¨æ—¥å¿—ã€ç¼“å­˜ç­‰ï¼‰
    â”œâ”€â”€ logs/                   # åº”ç”¨æ—¥å¿—
    â”œâ”€â”€ cache/                  # ç¼“å­˜æ–‡ä»¶
    â””â”€â”€ temp/                   # ä¸´æ—¶æ–‡ä»¶
```

## ğŸ” æƒé™è®¾ç½®

- **åº”ç”¨ç›®å½•**: `www-data:www-data` æƒé™ `755`
- **è¿è¡Œæ—¶ç›®å½•**: `www-data:www-data` æƒé™ `777`ï¼ˆå¯å†™ï¼‰

## âœ… éªŒè¯æ–¹æ³•

### 1. æµ‹è¯•è„šæœ¬è·¯å¾„
```bash
sudo web reload    # åº”è¯¥æ­£å¸¸å·¥ä½œ
sudo web restart   # åº”è¯¥æ­£å¸¸å·¥ä½œ
```

### 2. æµ‹è¯•æƒé™
```bash
sudo web fix-perms # ä¿®å¤æƒé™
```

### 3. æµ‹è¯•åº”ç”¨æ—¥å¿—å†™å…¥
```bash
# åœ¨å®¹å™¨å†…æµ‹è¯•
docker compose exec web touch /www/runtime/logs/test.log
```

## ğŸ¯ ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡éƒ¨ç½²**: è¿è¡Œ `./install.sh` æˆ– `./deploy.sh`
2. **æƒé™é—®é¢˜**: è¿è¡Œ `sudo web fix-perms`
3. **å¿«é€Ÿä¿®å¤**: è¿è¡Œ `./quick-fix.sh`
4. **æ—¥å¸¸ç®¡ç†**: ä½¿ç”¨ `sudo web [command]` å‘½ä»¤

## ğŸ“ æ³¨æ„äº‹é¡¹

- `runtime` ç›®å½•å·²åŒ…å«åœ¨åº”ç”¨æŒ‚è½½ä¸­ï¼Œæ— éœ€å•ç‹¬æŒ‚è½½
- æƒé™ä¿®å¤ä¼šè®¾ç½® `runtime` ç›®å½•ä¸º `777`ï¼Œç¡®ä¿åº”ç”¨å¯å†™
- æ‰€æœ‰è„šæœ¬ç°åœ¨éƒ½æœ‰æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥ï¼Œé¿å…è¦†ç›–ç°æœ‰æ–‡ä»¶
